{% extends "base.html" %}

{% block title %}ProdCumaru - Produtora Audiovisual{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/servicos/servicos.css') }}">
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  // Reutiliza a mesma public key
  window.EMAILJS_PUBLIC_KEY = window.EMAILJS_PUBLIC_KEY || "goVdFclsaAUdwx1uQ";
  // IDs do EmailJS para agendamento
  window.EMAILJS_SERVICE_ID = window.EMAILJS_SERVICE_ID || "service_uxchflv";
  window.EMAILJS_TEMPLATE_ID_AGENDAMENTO_CLIENTE = window.EMAILJS_TEMPLATE_ID_AGENDAMENTO_CLIENTE || "template_hk0zoyo";
  if (typeof emailjs !== "undefined" && window.EMAILJS_PUBLIC_KEY) {
    emailjs.init({ publicKey: window.EMAILJS_PUBLIC_KEY });
  }
</script>
{% endblock %}

{% block content %}

<main class="container-servicos">
  <section class="secao-busca-filtros">
    <div class="texto-chamada">
      <h1>
        Sua voz anunciada em <span class="destaque">Podcasts</span> e
        <span class="destaque">Talk Shows</span> em poucos cliques.
      </h1>
      <p>
        Escolha o serviço, o tema, a duração ou a equipe — com agendamentos
        a partir de R$ 99,90.
      </p>
    </div>

    <div class="container-filtros">
      <button class="filtro-btn ativo" data-filtro="todos">Todos</button>
      <button class="filtro-btn" data-filtro="podcast">Podcast</button>
      <button class="filtro-btn" data-filtro="talkshow">Talk Show</button>
      <button class="filtro-btn" data-filtro="musica">Música</button>
      <button class="filtro-btn" data-filtro="streaming">
        Live Streaming
      </button>
      <button class="filtro-btn" data-filtro="videoaula">
        Video Aulas
      </button>
      <button class="filtro-btn" data-filtro="street">Sala Street</button>
      <button class="filtro-btn" data-filtro="acoustic">
        Lounge Acoustic
      </button>
    </div>
  </section>

  <section class="secao-selecao-servico">
    <h2>Nossos Pacotes de Podcast</h2>
    <p class="descricao-secao">
      Selecione o pacote ideal para o seu projeto e agende seu horário.
    </p>

    <div class="grid-servicos">
      <div class="cartao-servico" data-tipo="podcast acoustic">
        <i class="ph-fill ph-microphone-stage"></i>
        <h3>CUMARU Básico</h3>
        <p>
          Clientes com experiência que necessitam apenas do espaço físico e
          suporte técnico básico.
        </p>
        <ul class="lista-itens-pacote">
          <li>
            <i class="ph-bold ph-check-circle"></i>Estúdio Acústico Premium
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Técnico de Mesa</li>
          <li><i class="ph-bold ph-check-circle"></i>Áudio em WAV/MP3</li>
        </ul>
        <span class="preco-servico">A partir de R$ 350 (1h)</span>
        <button class="botao-agendar" data-servico="basico">
          Agendar Pacote Básico
        </button>
      </div>

      <div class="cartao-servico destaque-pacote" data-tipo="podcast talkshow acoustic">
        <span class="badge-mais-vendido">Mais Vendido</span>
        <i class="ph-fill ph-monitor-play"></i>
        <h3>CUMARU Standard</h3>
        <p>
          Serviço completo para quem deseja produzir conteúdo audiovisual
          com suporte em todas as etapas.
        </p>
        <ul class="lista-itens-pacote">
          <li>
            <i class="ph-bold ph-check-circle"></i>Estúdio Acústico Premium
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Técnico de Mesa</li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Edição de Áudio e Vídeo
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>2 Cortes para Redes/h
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Equipe Técnica de Suporte
          </li>
        </ul>
        <span class="preco-servico">A partir de R$ 550 (1h)</span>
        <button class="botao-agendar" data-servico="standard">
          Agendar Pacote Standard
        </button>
      </div>

      <div class="cartao-servico" data-tipo="podcast talkshow streaming videoaula acoustic">
        <i class="ph-fill ph-star"></i>
        <h3>CUMARU Premium</h3>
        <p>
          Serviço de alta qualidade, com suporte completo e direcionamento
          personalizado.
        </p>
        <ul class="lista-itens-pacote">
          <li><i class="ph-bold ph-check-circle"></i>Tudo do Standard +</li>
          <li>
            <i class="ph-bold ph-check-circle"></i>1 teaser/chamada por
            episódio
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Equipe Técnica Completa
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Direção e Produção</li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Vinheta Sonora Exclusiva
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Recepção de Convidados
          </li>
        </ul>
        <span class="preco-servico">A partir de R$ 900 (1h)</span>
        <button class="botao-agendar" data-servico="premium">
          Agendar Pacote Premium
        </button>
      </div>

      <div class="cartao-servico" data-tipo="podcast acoustic">
        <i class="ph-fill ph-calendar-check"></i>
        <h3>CUMARU Assinatura</h3>
        <p>
          Pacotes mensais semestrais para quem tem produções recorrentes.
          (Valores por mês)
        </p>
        <ul class="lista-itens-pacote">
          <li>
            <i class="ph-bold ph-check-circle"></i>Estúdio Acústico Premium
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Técnico de Mesa</li>
          <li><i class="ph-bold ph-check-circle"></i>Áudio em WAV/MP3</li>
        </ul>
        <span class="preco-servico">A partir de R$ 1.100 (4h/mês)</span>
        <button class="botao-agendar" data-servico="assinatura">
          Consultar Assinatura
        </button>
      </div>

      <div class="cartao-servico" data-tipo="musica acoustic">
        <i class="ph-fill ph-music-notes"></i>
        <h3>Produção Musical</h3>
        <p>
          Gravação, captação, mixagem e masterização. Desde a criação de
          beats até a distribuição.
        </p>
        <ul class="lista-itens-pacote">
          <li>
            <i class="ph-bold ph-check-circle"></i>Captação de Voz (90/h)
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Criação de Beats (500)
          </li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Produção Completa (800)
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Mix/Master (300)</li>
        </ul>
        <span class="preco-servico">Sob Consulta</span>
        <button class="botao-agendar" data-servico="musica">
          Agendar Produção Musical
        </button>
      </div>

      <div class="cartao-servico" data-tipo="street">
        <i class="ph-fill ph-paint-brush"></i>
        <h3>Sala Street</h3>
        <p>
          Um estúdio com identidade urbana, ideal para podcasts e talk shows
          com uma estética moderna.
        </p>
        <ul class="lista-itens-pacote">
          <li><i class="ph-bold ph-check-circle"></i>Cenário Urbano</li>
          <li>
            <i class="ph-bold ph-check-circle"></i>Equipamento Completo
          </li>
          <li><i class="ph-bold ph-check-circle"></i>Técnico de Mesa</li>
        </ul>
        <span class="preco-servico">A partir de R$ 350 (1h)</span>
        <button class="botao-agendar" data-servico="street">
          Agendar Sala Street
        </button>
      </div>
    </div>
  </section>

  <section id="secao-calendario" class="secao-agendamento-detalhes" style="display: none">
    <div class="container-agendamento-completo">
      <button id="botao-voltar-servicos" class="btn-voltar">
        <i class="fas fa-arrow-left"></i> Voltar para Serviços
      </button>

      <div class="grid-agendamento">
        <div class="coluna-selecao">
          <h2>Escolha Data e Hora</h2>
          <p class="descricao-secao-agenda">
            Para o serviço:
            <strong id="servico-selecionado-titulo" class="texto-destaque">---</strong>
          </p>

          <div class="container-calendario-agendamento">
            <div class="calendario-agendamento-header">
              <button id="mes-anterior-publico">
                <i class="fas fa-chevron-left"></i>
              </button>
              <h3 id="mes-ano-atual-publico">Outubro 2025</h3>
              <button id="mes-seguinte-publico">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
            <div class="calendario-agendamento-dias-semana">
              <div>Dom</div>
              <div>Seg</div>
              <div>Ter</div>
              <div>Qua</div>
              <div>Qui</div>
              <div>Sex</div>
              <div>Sáb</div>
            </div>
            <div class="calendario-agendamento-grid-dias"></div>
          </div>

          <div class="horarios-disponiveis" style="display: none" id="container-horarios">
            <h3>
              Horários para <span id="data-selecionada-titulo"></span>
            </h3>
            <div id="grid-horarios"></div>
          </div>
        </div>

        <div class="coluna-pagamento" id="container-pagamento" style="display: none">
          <div class="box-resumo">
            <h3>Resumo do Pedido</h3>
            <div class="item-resumo">
              <span>Serviço:</span>
              <span id="resumo-servico">---</span>
            </div>
            <div class="item-resumo">
              <span>Data/Hora:</span>
              <span id="resumo-data">---</span>
            </div>
            <div class="item-resumo total">
              <span>Valor Total:</span>
              <span id="resumo-valor">R$ 0,00</span>
            </div>
          </div>

          <form id="form-agendamento" class="form-agendamento">
            <h3>Seus Dados</h3>

            <!-- Mensagem para usuários não logados -->
            <div class="login-prompt-box" id="login-prompt-servicos" style="display: none;">
              <p style="color: var(--muted); font-size: 14px; margin-bottom: 10px;">
                Já tem cadastro?
                <a href="/login-cliente?next=/servicos"
                  style="color: var(--accent); font-weight: bold; text-decoration: none;">
                  Faça login
                </a>
                para agendar mais rápido!
              </p>
            </div>

            <!-- Card resumo para usuários logados -->
            <div id="user-summary-card-servicos" style="display: none;"></div>

            <div class="tabs-pessoa" id="tabs-pessoa-servicos">
              <button type="button" class="tab-pessoa ativo" data-target="pf">
                Pessoa Física
              </button>
              <button type="button" class="tab-pessoa" data-target="pj">
                Pessoa Jurídica
              </button>
            </div>
            <input type="hidden" id="tipo-pessoa" value="pf" />

            <div class="form-group">
              <label>Nome Completo</label>
              <input type="text" id="nome-cliente" name="nome-cliente" placeholder="Seu nome" required />
            </div>

            <div id="campos-pf" class="campos-grupo">
              <div class="form-group">
                <label>CPF</label>
                <input type="text" id="cpf-cliente" name="cpf-cliente" placeholder="000.000.000-00" />
              </div>
            </div>

            <div id="campos-pj" class="campos-grupo" style="display: none">
              <div class="form-row">
                <div class="form-group">
                  <label>CNPJ</label>
                  <input type="text" id="cnpj-cliente" name="cnpj-cliente" placeholder="00.000.000/0001-00" />
                </div>
                <div class="form-group">
                  <label>Nome da Empresa</label>
                  <input type="text" id="empresa-cliente" name="empresa-cliente" placeholder="Razão Social" />
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>E-mail</label>
                <input type="email" id="email-cliente" name="email-cliente" placeholder="seu@email.com" required />
              </div>
              <div class="form-group">
                <label>Telefone / WhatsApp</label>
                <input type="tel" id="telefone-cliente" name="telefone-cliente" placeholder="(XX) 9XXXX-XXXX"
                  required />
              </div>
            </div>

            <div class="area-senha-cadastro">
              <h3>Acesso ao Portal</h3>
              <p class="aviso-senha">
                Crie uma senha para acompanhar seu agendamento no Portal do
                Cliente.
              </p>

              <div class="form-row">
                <div class="form-group">
                  <label>Crie uma Senha</label>
                  <input type="password" id="senha-cliente" name="senha-cliente" placeholder="Mínimo 6 caracteres"
                    required />
                </div>

                <div class="form-group">
                  <label>Confirmar Senha</label>
                  <input type="password" id="confirma-senha-cliente" name="confirma-senha-cliente"
                    placeholder="Repita a senha" required />
                </div>
              </div>
            </div>

            <h3>Pagamento</h3>

            <div class="tabs-pagamento">
              <button type="button" class="tab-pag ativo" data-metodo="credito">
                Crédito
              </button>
              <button type="button" class="tab-pag" data-metodo="debito">
                Débito
              </button>
              <button type="button" class="tab-pag" data-metodo="pix">
                PIX
              </button>
            </div>
            <input type="hidden" id="metodo-pagamento" value="credito" />

            <div id="area-pagamento-cartao">
              <div class="dados-cartao">
                <div class="form-group">
                  <label>Número do Cartão</label>
                  <div class="input-com-icone">
                    <i class="far fa-credit-card"></i>
                    <input type="text" placeholder="0000 0000 0000 0000" maxlength="19" />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>Validade</label>
                    <input type="text" placeholder="MM/AA" maxlength="5" />
                  </div>
                  <div class="form-group">
                    <label>CVV</label>
                    <input type="text" placeholder="123" maxlength="4" />
                  </div>
                </div>
                <div class="form-group">
                  <label>Nome no Cartão</label>
                  <input type="text" placeholder="Como impresso no cartão" />
                </div>

                <div class="form-group" id="grupo-parcelas">
                  <label>Parcelamento</label>
                  <select id="select-parcelas" class="select-parcelas">
                    <option value="1">1x (À vista)</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="area-pagamento-pix" style="display: none">
              <div class="box-pix">
                <i class="fas fa-qrcode"></i>
                <p>
                  O código QR e a chave PIX serão gerados após a
                  confirmação.
                </p>
                <span class="desconto-pix">Ganhe <strong>5% de desconto</strong> no PIX!</span>
              </div>
            </div>

            <button type="submit" class="botao-confirmar-final">
              Confirmar e Pagar
            </button>
          </form>
        </div>
      </div>
    </div>

    <div id="tela-confirmacao" class="tela-confirmacao" style="display: none">
      <div class="card-sucesso">
        <div class="icone-sucesso">
          <i class="fas fa-check"></i>
        </div>
        <h2>Pedido Confirmado!</h2>
        <p>
          Seu agendamento foi realizado com sucesso e sua conta foi criada.
        </p>
        <p class="detalhe-email">
          Enviamos um e-mail com os detalhes para
          <strong id="email-confirmacao-texto"></strong>.
        </p>

        <div class="acoes-sucesso">
          <a href="{{ url_for('portal') }}" class="botao-primario botao-portal">
            <i class="fas fa-user"></i> Acessar Portal do Cliente
          </a>
          <a href="{{ url_for('home') }}" class="link-voltar-home">Voltar para Home</a>
        </div>
      </div>
    </div>
  </section>

  <div class="secao-erro" style="display: none">
    <p>Erro ao carregar podcasts</p>
    <button class="botao-erro">Tentar Novamente</button>
  </div>

  <!-- Drawer/backdrop removidos aqui; usados do base.html -->

  <div class="modal-backdrop" id="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <h3 id="modal-title">Opções do produto</h3>
      <div id="modal-content"></div>
      <div style="
              display: flex;
              gap: 10px;
              justify-content: flex-end;
              margin-top: 14px;
            ">
        <button class="btn" id="modal-close">Fechar</button>
        <button class="btn" id="modal-add" style="background: var(--accent); color: #fff; border: 0">
          Adicionar ao carrinho
        </button>
      </div>
    </div>
  </div>
</main>

{% endblock %}

{% block scripts_extra %}

<script src="{{ url_for('static', filename='js/servicos/servicos.js') }}"></script>
{% endblock %}